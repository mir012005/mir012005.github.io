<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Simulation Ligue des Champions</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>‚öΩ Simulation LDC</h1>
        <nav>
            <button onclick="showPage('home')">Accueil</button>
            <button onclick="showPage('analyses'); chargerAnalysesGlobales()">Analyses Globales</button>
            <button onclick="showPage('duel')">‚öîÔ∏è Duel</button>
            <button onclick="showPage('ranking'); chargerClassement()">üèÜ Classement</button>
            <button onclick="showPage('match-impact')">‚ö° Impact Matchs</button>
            <button onclick="showPage('probas-zone')">üìä Probabilit√©s</button>
            <button onclick="showPage('impact-zone')">üîÆ Sc√©narios & Hype</button>
        </nav>
    </header>

    <main>
        <section id="home" class="page">
            <div class="hero">
                <h2>Bienvenue sur le Simulateur LDC</h2>
                <p>Ce projet utilise la m√©thode de Monte Carlo et les lois de Poisson pour pr√©dire la fin de la saison.</p>
                
                <input type="hidden" id="club">
            </div>

            <div class="clubs-container">
                <h3>Choisissez une √©quipe :</h3>
                <div id="clubsGrid" class="clubs-grid">
                    <div class="loader"></div> Chargement...
                </div>
            </div>
        </section>

        <section id="duel" class="page" style="display:none;">
            <h2>üîÆ Pr√©dicteur de Match</h2>
            <p>Simulez une rencontre sp√©cifique en utilisant le mod√®le Elo + Poisson.</p>

            <div class="duel-container">
                <div class="team-selector">
                    <label>Domicile üè†</label>
                    <select id="selHome"></select>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team-selector">
                    <label>Ext√©rieur ‚úàÔ∏è</label>
                    <select id="selAway"></select>
                </div>
            </div>

            <div style="text-align:center; margin-top:20px;">
                <button class="big-btn" onclick="lancerDuel()">Simuler le match</button>
            </div>

            <div id="duelResult" class="duel-result" style="display:none;">
                <div class="score-board">
                    <div class="team-score">
                        <span id="resHomeName">Home</span>
                        <span id="resHomeScore" class="score-digit">0</span>
                    </div>
                    <div class="divider">-</div>
                    <div class="team-score">
                        <span id="resAwayName">Away</span>
                        <span id="resAwayScore" class="score-digit">0</span>
                    </div>
                </div>
                <div class="proba-bar-container">
                    <div id="barWin" class="p-bar win">Win</div>
                    <div id="barDraw" class="p-bar draw">Draw</div>
                    <div id="barLoss" class="p-bar loss">Loss</div>
                </div>
            </div>
        </section>
        
        <section id="ranking" class="page" style="display:none;">
            <h2>üèÜ Classement Projet√© (Moyenne)</h2>
            <p>Simulez le classement sur une p√©riode pr√©cise.</p>
            
            <div class="controls-bar">
                <div class="control-group">
                    <label for="startDay">Situation de d√©part (Apr√®s) :</label>
                    <select id="startDay">
                        <option value="0" selected>J0 (D√©but)</option>
                        <option value="1">J1</option>
                        <option value="2">J2</option>
                        <option value="3">J3</option>
                        <option value="4">J4</option>
                        <option value="5">J5</option>
                        <option value="6">J6 (Actuel)</option>
                        <option value="7">J7</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="endDay">Simuler jusqu'√† la :</label>
                    <select id="endDay">
                        <option value="1">J1</option>
                        <option value="2">J2</option>
                        <option value="3">J3</option>
                        <option value="4">J4</option>
                        <option value="5">J5</option>
                        <option value="6">J6</option>
                        <option value="7">J7</option>
                        <option value="8" selected>J8 (Fin)</option>
                    </select>
                </div>
                <button class="action-btn" onclick="chargerClassement()">üîÑ Calculer</button>
            </div>

            <div class="table-container">
                <table class="ranking-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th style="text-align:left;">Club</th>
                            <th>Pts</th>
                            <th>Diff.</th>
                            <th>Buts</th>
                            <th class="secondary-stat">Buts Ext.</th>
                            <th>Vic.</th>
                            <th class="secondary-stat">Vict. Ext.</th>
                        </tr>
                    </thead>
                    <tbody id="rankingBody">
                        <tr><td colspan="8" style="text-align:center;">Cliquez sur Calculer...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <div class="legend">
                <span class="dot green"></span> Qualif Directe (1-8)
                <span class="dot orange"></span> Barrages (9-24)
                <span class="dot red"></span> √âlimin√© (25-36)
            </div>
        </section>

        <section id="results" class="page" style="display:none;">
            <h2>R√©sultats de la simulation</h2>
            
            <button onclick="showPage('home')" class="back-btn">‚Üê Choisir un autre club</button>
            
            <div class="controls-bar" style="margin: 0 0 20px 0; justify-content: center; background-color: #f0f7ff; border: 1px solid #cce5ff;">
                <div class="control-group" style="flex-direction: row; align-items: center; gap: 10px;">
                    <label for="simDaySelect" style="font-weight:bold; color:#002f5f; margin:0;">
                        üìÖ Simuler la fin de saison √† partir de la :
                    </label>
                    <select id="simDaySelect" onchange="simulate()" style="padding:8px; border:2px solid #0066cc; border-radius:6px; font-weight:bold; color:#002f5f; cursor:pointer; background: white;">
                        <option value="0" selected>J0 (D√©but de saison)</option>
                        <option value="1">Journ√©e 1</option>
                        <option value="2">Journ√©e 2</option>
                        <option value="3">Journ√©e 3</option>
                        <option value="4">Journ√©e 4</option>
                        <option value="5">Journ√©e 5</option>
                        <option value="6">Journ√©e 6</option>
                        <option value="7">Journ√©e 7</option>
                        <option value="8">Journ√©e 8</option>
                    </select>
                </div>
            </div>
            
            <div id="resultsContainer"></div>
        </section>

        <section id="analyses" class="page" style="display:none;">
            <h2>Analyses Globales (Monte Carlo)</h2>
            
            <div class="analysis-section">
                <div class="controls-bar" style="margin-bottom: 20px; justify-content: center;">
                    <div class="control-group">
                        <label>Situation de d√©part :</label>
                        <select id="analysesStartDay">
                            <option value="0"selected>J0 (D√©but Saison)</option>
                            <option value="1">J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                        </select>
                    </div>
                    <button class="action-btn" onclick="chargerAnalysesGlobales()">üîÑ Actualiser</button>
                </div>

                <h3>1. Les Seuils de Qualification</h3>
                <p>Combien de points faut-il pour se qualifier ?</p>
                <div class="charts-row">
                    <div class="chart-wrapper">
                        <h4>Pour le Top 8 (Qualif Directe)</h4>
                        <div class="chart-area"><canvas id="chartTop8"></canvas></div>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Pour le Top 24 (Barrages)</h4>
                        <div class="chart-area"><canvas id="chartBarrage"></canvas></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="probas-zone" class="page" style="display:none;">
            <h2>üìä Probabilit√©s de Qualification</h2>
            <p>Estimation des chances de chaque club selon la journ√©e de d√©part (Simul√© 1000 fois).</p>

            <div class="controls-bar">
                <div class="control-group">
                    <label>Situation apr√®s la :</label>
                    <select id="probaStartDay">
                        <option value="0" selected>J0 (D√©but Saison)</option>
                        <option value="1">Journ√©e 1</option>
                        <option value="2">Journ√©e 2</option>
                        <option value="3">Journ√©e 3</option>
                        <option value="4">Journ√©e 4</option>
                        <option value="5">Journ√©e 5</option>
                        <option value="6">Journ√©e 6 (Actuel)</option>
                        <option value="7">Journ√©e 7</option>
                    </select>
                </div>
                <button class="action-btn" onclick="chargerProbas()">Calculer les chances</button>
            </div>

            <div class="probas-container">
                <div class="proba-column">
                    <h3 class="green-text">üèÜ Favoris Top 8 (Qualif Directe)</h3>
                    <div class="table-wrapper">
                        <table class="ranking-table">
                            <thead>
                                <tr><th>#</th><th style="text-align:left;">Club</th><th>% Chance</th></tr>
                            </thead>
                            <tbody id="tbodyTop8">
                                <tr><td colspan="3">Cliquez sur Calculer...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="proba-column">
                    <h3 class="orange-text">üéüÔ∏è Favoris Top 24 (Barrages + Top8)</h3>
                    <div class="table-wrapper">
                        <table class="ranking-table">
                            <thead>
                                <tr><th>#</th><th style="text-align:left;">Club</th><th>% Chance</th></tr>
                            </thead>
                            <tbody id="tbodyQualif">
                                <tr><td colspan="3">Cliquez sur Calculer...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="match-impact" class="page" style="display:none;">
            <h2>‚ö° Impact des Matchs</h2>
            
            <div class="impact-tabs">
                <button class="tab-btn active" onclick="switchImpactTab('specific')">üîç Match Sp√©cifique</button>
                <button class="tab-btn" onclick="switchImpactTab('qualif')">üéØ Qualification</button>
                <button class="tab-btn" onclick="switchImpactTab('top8')">üèÜ Top 8</button>
            </div>

            <div id="impact-specific" class="impact-tab-content" style="display: block;">
                <div class="controls-bar">
                    <input type="text" id="impactClub" placeholder="Ex: Arsenal" list="clubsList">
                    <datalist id="clubsList"></datalist>
                    <select id="impactJournee">
                        <option value="1">J1</option>
                        <option value="2">J2</option>
                        <option value="3">J3</option>
                        <option value="4">J4</option>
                        <option value="5">J5</option>
                        <option value="6">J6</option>
                        <option value="7" selected>Journ√©e 7</option>
                        <option value="8">Journ√©e 8</option>
                    </select>
                    <button class="action-btn" onclick="analyserImpactMatch()">üîç Analyser</button>
                </div>
                <div id="impactResults"></div>
            </div>

            <div id="impact-qualif" class="impact-tab-content" style="display:none;">
                <div class="info-box">
                    <p><strong>üìä Classement des matchs par impact sur la QUALIFICATION</strong></p>
                    <p>Ces matchs changent le plus les probabilit√©s de finir dans le top 24.</p>
                </div>
                <button class="action-btn" onclick="chargerMatchsImportants('qualif')">üîÑ Charger les matchs J7</button>
                <div id="tableQualif"></div>
            </div>

            <div id="impact-top8" class="impact-tab-content" style="display:none;">
                <div class="info-box">
                    <p><strong>üèÜ Classement des matchs par impact sur le TOP 8</strong></p>
                    <p>Ces matchs changent le plus les probabilit√©s de finir dans le top 8.</p>
                </div>
                <button class="action-btn" onclick="chargerMatchsImportants('top8')">üîÑ Charger les matchs J7</button>
                <div id="tableTop8"></div>
            </div>
        </section>
    
        <section id="impact-zone" class="page" style="display:none;">
            <h2>üí• Analyse d'Impact & Enjeux</h2>
            <p>Utilisez les fonctions de simulation avanc√©es pour pr√©dire l'avenir.</p>

            <div class="tabs-container">
                <button class="tab-btn active" onclick="switchScenarioTab('scenario')">üîÆ Sc√©nario (What-If)</button>
                <button class="tab-btn" onclick="switchScenarioTab('hype')">üî• Hype-o-m√®tre</button>
            </div>

            <div id="scenario-tab" class="impact-tab-content">
                <div class="search-box">
                    <div class="control-group">
                        <label>D√©part (Historique) :</label>
                        <select id="scenarioStartDay">
                            <option value="0" selected>J0 (D√©but)</option>
                            <option value="1">J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Match en :</label>
                        <select id="scenarioTargetDay">
                            <option value="1">J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                            <option value="8" selected>J8</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Club & R√©sultat :</label>
                        <select id="scenarioClub">
                            <option value="" disabled selected>-- Choisir --</option>
                        </select>

                        <select id="scenarioResult">
                            <option value="V">Victoire</option>
                            <option value="N">Nul</option>
                            <option value="D">D√©faite</option>
                        </select>
                    </div>
                    <button class="action-btn" onclick="lancerScenario()">Simuler</button>
                </div>

                <div id="scenarioResultBox" style="margin-top:20px; display:none;">
                    <h3 id="scenarioTitle" style="text-align:center; color:#002f5f; margin-bottom:20px;">Analyse d'Impact</h3>
                    
                    <div class="impact-comparison-container">
                        <div class="impact-col before">
                            <h4>Situation Actuelle</h4>
                            <div class="stat-row">
                                <span>Qualif (Top 24)</span>
                                <strong id="beforeQualif">--%</strong>
                            </div>
                            <div class="stat-row">
                                <span>Top 8</span>
                                <strong id="beforeTop8">--%</strong>
                            </div>
                        </div>

                        <div class="impact-arrow">
                            <div id="resBadge" class="result-badge">Si R√©sultat</div>
                        </div>

                        <div class="impact-col after">
                            <h4>Nouvelle Projection</h4>
                            <div class="stat-row">
                                <span>Qualif (Top 24)</span>
                                <div style="display:flex; align-items:center;">
                                    <strong id="afterQualif" class="big-number">--%</strong>
                                    <span id="diffQualif" class="diff-badge">--</span>
                                </div>
                            </div>
                            <div class="stat-row">
                                <span>Top 8</span>
                                <div style="display:flex; align-items:center;">
                                    <strong id="afterTop8" class="big-number">--%</strong>
                                    <span id="diffTop8" class="diff-badge">--</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="scenarioVerdict" class="verdict-box" style="margin-top: 15px;">...</div>
                </div>
            </div>

            <div id="hype-tab" class="impact-tab-content" style="display:none;">
                <div class="controls-bar">
                    <div class="control-group">
                        <label>Contexte :</label>
                        <select id="impStartDay">
                            <option value="0">J0 (D√©but)</option>
                            <option value="1" selected>J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Analyser :</label>
                        <select id="impTargetDay">
                            <option value="1">J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                            <option value="8" selected>J8</option>
                        </select>
                    </div>
                    <button class="action-btn" onclick="chargerImportance()">Calculer Hype</button>
                </div>
                <div id="importanceList" class="matches-list">
                    <div class="placeholder-text">Cliquez sur calculer pour voir les matchs importants...</div>
                </div>
            </div>
        </section>
        
    </main>

    <script src="script.js"></script>
</body>
</html>