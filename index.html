<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulation Ligue des Champions</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>
            <img src="logo_ldc_sans_texte.png" alt="Logo Champions League" class="header-logo">
            
            Champions League Simulation
        </h1>
        <!--
        <nav>
            <button onclick="showPage('home')">Accueil</button>
            <button onclick="showPage('analyses'); chargerAnalysesGlobales()">Analyses Globales</button>
            <button onclick="showPage('duel')">‚öîÔ∏è Duel</button>
            <button onclick="showPage('ranking'); chargerClassement()">üèÜ Classement</button>
            <button onclick="showPage('match-impact')">‚ö° Impact Matchs</button>
            <button onclick="showPage('probas-zone')">üìä Probabilit√©s</button>
            <button onclick="showPage('impact-zone')">üîÆ Sc√©narios & Hype</button>
            <button id="theme-toggle" class="theme-btn" onclick="toggleTheme()"> üåô Mode Nuit</button>
        </nav>
        -->
        <nav>
            <button onclick="showPage('home')"><i class="fa-solid fa-house"></i> <span data-i18n="nav_home">Accueil</span></button>
            <button onclick="showPage('analyses'); chargerAnalysesGlobales()"><i class="fa-solid fa-chart-line"></i> <span data-i18n="nav_analyses">Analyses</span></button>
            <button onclick="showPage('duel')"><i class="fa-solid fa-shield-halved"></i> <span data-i18n="nav_duel">Duel</span></button>
            <button onclick="showPage('ranking'); chargerClassement()"><i class="fa-solid fa-trophy"></i> <span data-i18n="nav_ranking">Classement</span></button>
            <button onclick="showPage('probas-zone')"><i class="fa-solid fa-chart-pie"></i> <span data-i18n="nav_probas">Probabilit√©s</span></button>    
            <button onclick="showPage('impact-zone')"><i class="fa-solid fa-flask"></i> <span data-i18n="nav_labo">Labo & Hype</span></button>
            <button onclick="showPage('about')"><i class="fa-solid fa-circle-info"></i> <span data-i18n="nav_about">A propos</span></button>
            
            <button id="theme-toggle" class="theme-btn" onclick="toggleTheme()"><i class="fa-solid fa-moon"></i> <span data-i18n="theme_night">Mode Nuit</span></button>
            <button id="lang-toggle" class="theme-btn" onclick="toggleLanguage()"><i class="fa-solid fa-globe"></i> EN</button>
        </nav>
    </header>

    <main>
        <section id="home" class="page">
            <div class="hero">
                <h2 data-i18n="welcome">Bienvenue sur le Simulateur LDC</h2>
                <p data-i18n="description">Ce projet utilise la m√©thode de Monte Carlo et les lois de Poisson pour pr√©dire la fin de la saison.</p>

                <input type="hidden" id="club">
            </div>

            <div class="clubs-container">
                <h3 data-i18n="choose_team">Choisissez une √©quipe :</h3>
                <div id="clubsGrid" class="clubs-grid">
                    <div class="loader"></div> Chargement...
                </div>
            </div>
        </section>

        <section id="duel" class="page" style="display:none;">
            <h2 data-i18n="duel_title">üîÆ Pr√©dicteur de Match</h2>
            <p data-i18n="duel_desc">Simulez une rencontre sp√©cifique en utilisant le mod√®le Elo + Poisson.</p>

            <div class="duel-container">
                <div class="team-selector">
                    <label data-i18n="home">Domicile üè†</label>
                    <select id="selHome"></select>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team-selector">
                    <label data-i18n="away">Ext√©rieur ‚úàÔ∏è</label>
                    <select id="selAway"></select>
                </div>
            </div>

            <div style="text-align:center; margin-top:20px;">
                <button class="big-btn" onclick="lancerDuel()" data-i18n="simulate_match">Simuler le match</button>
            </div>

            <div id="duelResult" class="duel-result" style="display:none;">
                <div class="score-board">
                    <div class="team-score">
                        <span id="resHomeName">Home</span>
                        <span id="resHomeScore" class="score-digit">0</span>
                    </div>
                    <div class="divider">-</div>
                    <div class="team-score">
                        <span id="resAwayName">Away</span>
                        <span id="resAwayScore" class="score-digit">0</span>
                    </div>
                </div>
                <div class="proba-bar-container">
                    <div id="barWin" class="p-bar win">Win</div>
                    <div id="barDraw" class="p-bar draw">Draw</div>
                    <div id="barLoss" class="p-bar loss">Loss</div>
                </div>
            </div>
        </section>
        
        <section id="ranking" class="page" style="display:none;">
            <h2 data-i18n="ranking_title">üèÜ Classement Projet√© (Moyenne)</h2>
            <p data-i18n="ranking_desc">Simulez le classement sur une p√©riode pr√©cise.</p>
            
            <div class="controls-bar">
                <div class="control-group">
                    <label for="startDay">Situation de d√©part (Apr√®s) :</label>
                    <select id="startDay">
                        <option value="0" selected>J0 (D√©but)</option>
                        <option value="1">J1</option>
                        <option value="2">J2</option>
                        <option value="3">J3</option>
                        <option value="4">J4</option>
                        <option value="5">J5</option>
                        <option value="6">J6 (Actuel)</option>
                        <option value="7">J7</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="endDay">Simuler jusqu'√† la :</label>
                    <select id="endDay">
                        <option value="1">J1</option>
                        <option value="2">J2</option>
                        <option value="3">J3</option>
                        <option value="4">J4</option>
                        <option value="5">J5</option>
                        <option value="6">J6</option>
                        <option value="7">J7</option>
                        <option value="8" selected>J8 (Fin)</option>
                    </select>
                </div>
                <button class="action-btn" onclick="chargerClassement()">üîÑ Calculer</button>
            </div>

            <div class="table-container">
                <table class="ranking-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th style="text-align:left;">Club</th>
                            <th>Pts</th>
                            <th>Diff.</th>
                            <th>Buts</th>
                            <th class="secondary-stat">Buts Ext.</th>
                            <th>Vic.</th>
                            <th class="secondary-stat">Vict. Ext.</th>
                        </tr>
                    </thead>
                    <tbody id="rankingBody">
                        <tr><td colspan="8" style="text-align:center;">Cliquez sur Calculer...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <div class="legend">
                <span class="dot green"></span> Qualif Directe (1-8)
                <span class="dot orange"></span> Barrages (9-24)
                <span class="dot red"></span> √âlimin√© (25-36)
            </div>
        </section>

        <section id="results" class="page" style="display:none;">
            <h2 data-i18n="results_title">R√©sultats de la simulation</h2>
            
            <button onclick="showPage('home')" class="back-btn" data-i18n="back_btn">‚Üê Choisir un autre club</button>
            
            <div class="controls-bar" style="margin: 0 0 20px 0; justify-content: center; background-color: #f0f7ff; border: 1px solid #cce5ff;">
                <div class="control-group" style="flex-direction: row; align-items: center; gap: 10px;">
                    <label for="simDaySelect" style="font-weight:bold; color:#002f5f; margin:0;">
                        üìÖ Simuler la fin de saison √† partir de la :
                    </label>
                    <select id="simDaySelect" onchange="simulate()" style="padding:8px; border:2px solid #0066cc; border-radius:6px; font-weight:bold; color:#002f5f; cursor:pointer; background: white;">
                        <option value="0" selected>J0 (D√©but de saison)</option>
                        <option value="1">Journ√©e 1</option>
                        <option value="2">Journ√©e 2</option>
                        <option value="3">Journ√©e 3</option>
                        <option value="4">Journ√©e 4</option>
                        <option value="5">Journ√©e 5</option>
                        <option value="6">Journ√©e 6</option>
                        <option value="7">Journ√©e 7</option>
                        <option value="8">Journ√©e 8</option>
                    </select>
                </div>
            </div>
            
            <div id="resultsContainer"></div>
        </section>

        <section id="analyses" class="page" style="display:none;">
            <h2>Analyses Globales (Monte Carlo)</h2>
            
            <div class="analysis-section">
                <div class="controls-bar" style="margin-bottom: 20px; justify-content: center;">
                    <div class="control-group">
                        <label>Situation de d√©part :</label>
                        <select id="analysesStartDay">
                            <option value="0"selected>J0 (D√©but Saison)</option>
                            <option value="1">J1</option>
                            <option value="2">J2</option>
                            <option value="3">J3</option>
                            <option value="4">J4</option>
                            <option value="5">J5</option>
                            <option value="6">J6</option>
                            <option value="7">J7</option>
                        </select>
                    </div>
                    <button class="action-btn" onclick="chargerAnalysesGlobales()">üîÑ Actualiser</button>
                </div>

                <h3>1. Les Seuils de Qualification</h3>
                <p>Combien de points faut-il pour se qualifier ?</p>
                <div class="charts-row">
                    <div class="chart-wrapper">
                        <h4>Pour le Top 8 (Qualif Directe)</h4>
                        <div class="chart-area"><canvas id="chartTop8"></canvas></div>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Pour le Top 24 (Barrages)</h4>
                        <div class="chart-area"><canvas id="chartBarrage"></canvas></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="probas-zone" class="page" style="display:none;">
            <h2>üìä Probabilit√©s de Qualification</h2>
            <p>Estimation des chances de chaque club selon la journ√©e de d√©part (Simul√© 1000 fois).</p>

            <div class="controls-bar">
                <div class="control-group">
                    <label>Situation apr√®s la :</label>
                    <select id="probaStartDay">
                        <option value="0" selected>J0 (D√©but Saison)</option>
                        <option value="1">Journ√©e 1</option>
                        <option value="2">Journ√©e 2</option>
                        <option value="3">Journ√©e 3</option>
                        <option value="4">Journ√©e 4</option>
                        <option value="5">Journ√©e 5</option>
                        <option value="6">Journ√©e 6 (Actuel)</option>
                        <option value="7">Journ√©e 7</option>
                    </select>
                </div>
                <button class="action-btn" onclick="chargerProbas()">Calculer les chances</button>
            </div>

            <div class="probas-container">
                <div class="proba-column">
                    <h3 class="green-text">üèÜ Favoris Top 8 (Qualif Directe)</h3>
                    <div class="table-wrapper">
                        <table class="ranking-table">
                            <thead>
                                <tr><th>#</th><th style="text-align:left;">Club</th><th>% Chance</th></tr>
                            </thead>
                            <tbody id="tbodyTop8">
                                <tr><td colspan="3">Cliquez sur Calculer...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="proba-column">
                    <h3 class="orange-text">üéüÔ∏è Favoris Top 24 (Barrages + Top8)</h3>
                    <div class="table-wrapper">
                        <table class="ranking-table">
                            <thead>
                                <tr><th>#</th><th style="text-align:left;">Club</th><th>% Chance</th></tr>
                            </thead>
                            <tbody id="tbodyQualif">
                                <tr><td colspan="3">Cliquez sur Calculer...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    
        <section id="impact-zone" class="page" style="display:none;">
            <h2 data-i18n="labo_title">üí• Laboratoire & Enjeux</h2>
            <p data-i18n="labo_desc">Simulez des sc√©narios ou analysez les matchs cruciaux pour votre √©quipe.</p>

            <div class="tabs-container" style="margin-bottom: 25px; display:flex; justify-content:center; gap:15px;">
                <button id="btn-tab-scenario" class="tab-btn active" onclick="switchScenarioTab('scenario')">üîÆ Sc√©nario (What-If)</button>
                <button id="btn-tab-hypo" class="tab-btn" onclick="switchScenarioTab('hypo')">üéØ Hypo-m√®tre (Nouveau)</button>
            </div>

            <div id="tab-scenario" class="tab-content" style="display:block;">
                <div class="scenario-header">
                    <h3>üß™ Simulateur de R√©sultat</h3>
                    <p style="font-size:0.9em; color:#666;">Testez un r√©sultat sp√©cifique et voyez l'impact imm√©diat.</p>
                </div>

                <div class="controls-bar" style="justify-content: center; flex-wrap: wrap;">
                    <div class="control-group">
                        <label>D√©part :</label>
                        <select id="scenarioStartDay">
                            <option value="0" selected>J0 (D√©but de saison)</option>
                            <option value="1">Journ√©e 1</option>
                            <option value="2">Journ√©e 2</option>
                            <option value="3">Journ√©e 3</option>
                            <option value="4">Journ√©e 4</option>
                            <option value="5">Journ√©e 5</option>
                            <option value="6">Journ√©e 6</option>
                            <option value="7">Journ√©e 7</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Match en :</label>
                        <select id="scenarioTargetDay">
                            <option value="0" selected>J0 (D√©but de saison)</option>
                            <option value="1">Journ√©e 1</option>
                            <option value="2">Journ√©e 2</option>
                            <option value="3">Journ√©e 3</option>
                            <option value="4">Journ√©e 4</option>
                            <option value="5">Journ√©e 5</option>
                            <option value="6">Journ√©e 6</option>
                            <option value="7">Journ√©e 7</option>
                            <option value="8">Journ√©e 8</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>Hypoth√®se :</label>
                        <select id="scenarioClub">
                            <option value="" disabled selected>-- Club --</option>
                            </select>
                        <select id="scenarioResult">
                            <option value="V">Victoire</option>
                            <option value="N">Nul</option>
                            <option value="D">D√©faite</option>
                        </select>
                    </div>
                    
                    <button class="action-btn" onclick="lancerScenario()">Simuler</button>
                </div>

                <div id="scenarioResultBox" style="margin-top:20px; display:none;">
                    <div class="impact-comparison-container">
                        <div class="impact-col before">
                            <h4>Avant</h4>
                            <div class="stat-row"><span>Qualif</span><strong id="beforeQualif">--%</strong></div>
                            <div class="stat-row"><span>Top 8</span><strong id="beforeTop8">--%</strong></div>
                        </div>
                        <div class="impact-arrow"><div id="resBadge" class="result-badge">SI R√âSULTAT</div></div>
                        <div class="impact-col after">
                            <h4>Apr√®s</h4>
                            <div class="stat-row">
                                <span>Qualif</span>
                                <div><strong id="afterQualif">--%</strong> <span id="diffQualif" class="diff-badge">--</span></div>
                            </div>
                            <div class="stat-row">
                                <span>Top 8</span>
                                <div><strong id="afterTop8">--%</strong> <span id="diffTop8" class="diff-badge">--</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-hypo" class="tab-content" style="display:none;">
                <div class="scenario-header">
                    <h3>üéØ Analyse des Matchs Cl√©s</h3>
                    <p style="font-size:0.9em; color:#666;">Quels matchs des AUTRES devez-vous surveiller ?</p>
                </div>

                <div class="controls-bar" style="justify-content: center; max-width: 800px; margin: 0 auto 30px auto;">
                    <div class="control-group">
                        <label>Je supporte :</label>
                        <select id="hypo-club-select" class="club-selector">
                            </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Apr√®s la journ√©e :</label>
                        <select id="hypo-day-select">
                            <option value="0" selected>J0 (D√©but de saison)</option>
                            <option value="1">Journ√©e 1</option>
                            <option value="2">Journ√©e 2</option>
                            <option value="3">Journ√©e 3</option>
                            <option value="4">Journ√©e 4</option>
                            <option value="5">Journ√©e 5</option>
                            <option value="6">Journ√©e 6</option>
                            <option value="7">Journ√©e 7</option>
                            <option value="8">Journ√©e 8</option>
                        </select>
                    </div>

                    <button class="action-btn" onclick="lancerHypometre()">
                        <i class="fa-solid fa-radar"></i> Analyser
                    </button>
                </div>

                <div id="hypo-loading" class="loader" style="display:none; margin: 20px auto;"></div>
                <div id="hypo-resultats" class="matches-list" style="max-width: 800px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px;"></div>
            </div>
        </section>

        <section id="about" class="page" style="display:none;">
            <div class="about-container" style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <h2 style="text-align:center; margin-bottom: 30px;">Comment fonctionne ce simulateur ?</h2>
                
                <div class="about-card">
                    <h3>üß† La M√©thodologie</h3>
                    <p>Ce projet se base sur un mod√®le statistique developp√© dans le cadre d'un projet de d√©partement IMI par Paul Vandercoilden et Oscar P√©coud-Gatti sous la supervision de Julien Guyon :</p>
                    <ul style="line-height: 1.6; margin-top: 10px;">
                        <li><strong>Le Classement Elo :</strong> Chaque √©quipe poss√®de un score de force (Elo) qui √©volue apr√®s chaque match r√©el. C'est ce score qui influence le plus sur la probabilit√© de victoire.</li>
                        <li><strong>Loi math√©matique utilis√©e :</strong> Pour chaque match simul√©, nous utilisons <strong> la loi de Poisson</strong> pour g√©n√©rer des scores r√©alistes (0-0, 2-1, etc.) bas√©s sur les forces des √©quipes, jouer √† domicile ou pas, etc.</li>
                        <li><strong>La M√©thode de Monte Carlo :</strong> Nous ne simulons pas la saison une seule fois, mais <strong>1000 √† 10 000 fois</strong>. C'est la moyenne de ces milliers d'univers parall√®les qui donne les probabilit√©s affich√©es (ex: "PSG a 64% de chances de se qualifier").</li>
                    </ul>
                </div>

                <div class="about-card" style="margin-top: 20px;">
                    <h3>üìÖ Mise √† jour Dynamique</h3>
                    <p>Le simulateur est connect√© √† la r√©alit√©. Vous pouvez choisir de simuler la fin de saison depuis le d√©but (J0) ou depuis la situation actuelle (ex: apr√®s la J6), en prenant en compte les points d√©j√† acquis et la forme du moment.</p>
                </div>

                <div style="text-align:center; margin-top: 40px; color: var(--text-light);">
                    <p>D√©velopp√© par <strong>Idris Rayane MJIDI</strong>, <strong>Ilyas Zeriouel</strong>, <strong>Houssam Ehmimed</strong>, <strong>Naim El Ouassaidi</strong>.</p>
                    <p style="font-size: 0.9em;">Saison 2025/2026</p>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="footer-content">
            <p>Simulateur Ligue des Champions &copy; 2025/2026</p>
            
            <div class="socials">
                <a href="https://www.linkedin.com/in/idris-rayane-mjidi-17m01i2005r/" target="_blank" title="Linkedin Mjidi">
                    <i class="fa-brands fa-linkedin"></i>
                </a>
                <a href="https://www.linkedin.com/in/houssam-ehmimed-a24911359/" target="_blank" title="Linkedin Houssam">
                    <i class="fa-brands fa-linkedin"></i>
                </a>
                <a href="https://www.linkedin.com/in/ilyas-zeriouel-5ba9b5354/" target="_blank" title="Linkedin Ilyas">
                    <i class="fa-brands fa-linkedin"></i>
                </a>
                <a href="https://www.linkedin.com/in/na%C3%AFm-el-ouassaidi-81264a299/" target="_blank" title="Linkedin Naim">
                    <i class="fa-brands fa-linkedin"></i>
                </a>

            </div>
        </div>
    </footer>

    <script>
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('theme-toggle');
            
            body.classList.toggle('dark-mode');
            
            const isDark = body.classList.contains('dark-mode');
            const lang = localStorage.getItem('lang') || 'fr';
            
            if (isDark) {
                const text = lang === 'fr' ? 'Mode Jour' : 'Day Mode';
                btn.innerHTML = '<i class="fa-solid fa-sun"></i> <span data-i18n="theme_day">' + text + '</span>';
                localStorage.setItem('theme', 'dark');
            } else {
                const text = lang === 'fr' ? 'Mode Nuit' : 'Night Mode';
                btn.innerHTML = '<i class="fa-solid fa-moon"></i> <span data-i18n="theme_night">' + text + '</span>';
                localStorage.setItem('theme', 'light');
            }
        }

        // Au chargement de la page : v√©rifier la pr√©f√©rence sauvegard√©e
        window.onload = function() {
            const savedTheme = localStorage.getItem('theme');
            const lang = localStorage.getItem('lang') || 'fr';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                const text = lang === 'fr' ? 'Mode Jour' : 'Day Mode';
                document.getElementById('theme-toggle').innerHTML = '<i class="fa-solid fa-sun"></i> <span data-i18n="theme_day">' + text + '</span>';
            }
        };
    </script>

    <script src="script.js"></script>
</body>
</html>